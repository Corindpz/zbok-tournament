# PROMPT CURSOR - LOL TOURNAMENT MANAGER

Tu as acc√®s complet √† Supabase, peux cr√©er/modifier tous les fichiers et dossiers. Voici le projet complet √† construire.

## üéØ OBJECTIF GLOBAL
Cr√©er un site web de gestion de tournoi League of Legends pour une √©quipe d'amis avec :
- Gestion des √©quipes, joueurs, matchs
- Syst√®me de mercato (draft automatique)
- Feed d'actualit√©s en temps r√©el
- Profils joueurs avec stats
- Authentification avec admin key

## üõ†Ô∏è STACK TECHNIQUE
- **Frontend** : Next.js 14+ avec TypeScript
- **UI/UX** : Tailwind CSS + ShadcN/UI (design moderne et √©pur√©)
- **Backend/DB** : Supabase (PostgreSQL, Auth, Storage)
- **API Champions LoL** : Int√©gration API officielle Riot Games (donn√©es officielles des champions)
- **D√©ploiement** : Vercel (ou Netlify au besoin)
- **Gestion √©tat** : React Hooks + Context API ou Zustand

## üìä STRUCTURE DE DONN√âES SUPABASE

### Tables obligatoires :

**users**
- id (uuid, PK)
- email (string, unique)
- username (string, unique)
- password_hash (string)
- profile_picture_url (string, nullable)
- role (enum: 'player' | 'admin')
- is_active (boolean, default: true)
- created_at (timestamp)

**players**
- id (uuid, PK)
- user_id (uuid, FK ‚Üí users)
- ingame_nickname (string, unique)
- role (enum: 'TOP' | 'JUNGLE' | 'MID' | 'ADC' | 'SUPPORT', nullable et modifiable)
- profile_picture_url (string, nullable)
- total_matches (integer, default: 0)
- total_wins (integer, default: 0)
- is_inactive (boolean, default: false)
- inactive_reason (string, nullable) // raison du fired
- created_at (timestamp)

**teams**
- id (uuid, PK)
- name (string, unique)
- captain_id (uuid, FK ‚Üí players)
- logo_url (string, nullable)
- created_at (timestamp)
- created_month (timestamp) // date de cr√©ation pour savoir si renouvellement mercato

**team_players**
- id (uuid, PK)
- team_id (uuid, FK ‚Üí teams)
- player_id (uuid, FK ‚Üí players)
- is_substitute (boolean, default: false)
- joined_at (timestamp)

**player_stats**
- id (uuid, PK)
- player_id (uuid, FK ‚Üí players)
- champion (string) // nom du champion jou√©
- matches_with_champion (integer, default: 0)
- wins_with_champion (integer, default: 0)
- total_damage (integer, nullable)
- created_at (timestamp)

**matches**
- id (uuid, PK)
- team_1_id (uuid, FK ‚Üí teams)
- team_2_id (uuid, FK ‚Üí teams)
- winner_id (uuid, FK ‚Üí teams, nullable)
- team_1_score (integer, nullable)
- team_2_score (integer, nullable)
- match_date (timestamp)
- created_at (timestamp)

**match_details** (optionnel mais recommand√©)
- id (uuid, PK)
- match_id (uuid, FK ‚Üí matches)
- player_id (uuid, FK ‚Üí players)
- champion_played (string)
- damage_dealt (integer, nullable)
- kills (integer, nullable)
- deaths (integer, nullable)
- assists (integer, nullable)

**news_feed**
- id (uuid, PK)
- type (enum: 'match_result' | 'player_transfer' | 'team_created')
- title (string)
- description (string)
- related_id (uuid, nullable) // ID du match ou joueur concern√©
- created_at (timestamp)

**mercato_settings**
- id (uuid, PK)
- mercato_date (timestamp) // date de renouvellement
- is_active (boolean)
- number_of_teams (integer)
- updated_at (timestamp)

## üé® DESIGN & UI/UX
- Design moderne et √©pur√© (minimaliste, inspir√© Figma/Discord)
- Dark mode par d√©faut (toggle en param√®tres)
- Palette couleur : Bleus/Mauve/Gris neutres (style gaming pro)
- Responsive mobile-first
- Animations fluides (Framer Motion optional)
- Typography claire (Geist ou Inter)

## üì± PAGES & FONCTIONNALIT√âS

### 1Ô∏è‚É£ PAGE ACCUEIL
- Feed d'actualit√©s (derniers matchs, transferts, changements d'√©quipes)
- Classement des √©quipes (par winrate d√©croissant)
- Prochains matchs
- Stats rapides (nombre de joueurs, √©quipes actives)

### 2Ô∏è‚É£ ONGLET AUTHENTIFICATION
- **Login** : email + mot de passe OU admin key sp√©ciale (d√©finie en config)
- **Register** : cr√©ation compte joueur (email, password, username, ingame_nickname)
- Les admins acc√®dent √† tout avec la cl√© secr√®te
- Les joueurs peuvent modifier leur profil (role, photo de profil)

### 3Ô∏è‚É£ ONGLET PROFIL (accessible apr√®s login)
- Fiche joueur personnelle
- Photo de profil (upload Supabase)
- Pseudo in-game
- R√¥le (modifiable)
- Stats globales (winrate, total matches, total wins)
- Winrate par champion jou√©
- √âquipe actuelle (ou "Rempla√ßant" ou "Sans √©quipe")
- Historique des matchs
- Bouton pour modifier son profil

### 4Ô∏è‚É£ ONGLET √âQUIPES
- Liste de toutes les √©quipes en cours
- Pour chaque √©quipe : nom, winrate, logo, capitaine, 5 joueurs (4 titulaires + subs visibles)
- **ADMIN ONLY** : 
  - Bouton "G√©rer √©quipe" (CRUD sur joueurs, changer capitaine)
  - Bouton "Supprimer √©quipe"
  - Bouton "Marquer joueur comme inactif" (avec raison : "Int games", "Inactif", etc.)

### 5Ô∏è‚É£ ONGLET MATCHS
- Liste des matchs (pass√©s et √† venir)
- Cr√©er un match (ADMIN ONLY)
- Entrer r√©sultats manuellement (ADMIN ONLY)
- Afficher :
  - √âquipes impliqu√©es, score final
  - Date du match
  - Pour chaque joueur : champion jou√©, d√©g√¢ts, K/D/A (si saisi)
  - D√©tails compl√®tes du match en cliquant dessus

### 6Ô∏è‚É£ ONGLET R√àGLES
- Page statique avec toutes les r√®gles :
  - Les √©quipes durent 1 mois (mercato chaque mois √† la m√™me date)
  - Si un joueur absent, le capitaine peut appeler un rempla√ßant
  - Un joueur peut √™tre vir√© de l'√©quipe s'il "int" (mauvais comportement)
  - Autres r√®gles √† ajouter selon vos envies

### 7Ô∏è‚É£ ONGLET MERCATO (ADMIN ONLY)
- Affiche la date du prochain mercato
- Bouton "Lancer le mercato" (si date atteinte)
- **Processus du mercato** :
  1. Admin rentre le nombre d'√©quipes souhait√©
  2. Capitaines choisis AL√âATOIREMENT parmi les joueurs
  3. Les autres joueurs sont marqu√©s "disponibles"
  4. **Phase de draft** :
     - Les capitaines choisissent en ordre al√©atoire, tour par tour
     - Chaque capitaine pick 1 joueur √† tour de r√¥le
     - Une fois toutes les √©quipes √† 3 joueurs (cap + 2) ‚Üí lancer la roue
  5. **Phase roue** :
     - Chaque capitaine (en ordre al√©atoire) lance la roue
     - Un joueur al√©atoire parmi les restants rejoint son √©quipe
     - R√©p√©ter jusqu'√† fin des joueurs
  6. Les joueurs restants = rempla√ßants globaux (comptent dans toutes les √©quipes)
  7. Confirmation et nouvelle saison lanc√©e
  8. News feed mise √† jour automatiquement

### 8Ô∏è‚É£ ONGLET PARAM√àTRES (ADMIN ONLY)
- Toggle Dark Mode / Light Mode
- Afficher la cl√© admin (masqu√©e par d√©faut)
- Configuration Supabase (si n√©cessaire)
- Autres param√®tres syst√®me

## üîê AUTHENTIFICATION & AUTORISATIONS
- **Public** : Accueil, Rules
- **Players** : Profil perso, voir √âquipes/Matchs, News feed
- **Admin Only** : Mercato, Param√®tres, Gestion √©quipes/joueurs, Lancer matchs, Entrer r√©sultats, Marquer joueur inactif
- Admin utilise une cl√© sp√©ciale (string) d√©finie en config/environment
- V√©rifier la cl√© √† la connexion pour octroyer les droits admin

## üì° API RIOT GAMES
- Utiliser l'API officielle Riot Games pour :
  - R√©cup√©rer liste compl√®te des champions + images
  - Afficher l'ic√¥ne/image du champion jou√©
  - Stats officielles du champion (si besoin)
- Stocker les donn√©es en cache (Redis ou Supabase) pour √©viter appels r√©p√©t√©s
- Documentation : https://developer.riotgames.com/

## üì∏ UPLOADS FICHIERS
- Format : JPG/PNG
- Taille max : 5MB
- Dossier Supabase Storage : `/profiles` (joueurs) et `/teams` (logos √©quipes)
- Utiliser signed URLs pour les images

## üîÑ CALCUL WINRATE
- **Winrate joueur** = total_wins / total_matches * 100
- **Winrate par champion** = wins_with_champion / matches_with_champion * 100
- Les rempla√ßants qui jouent = leurs stats comptent aussi
- Mis √† jour automatiquement apr√®s chaque entr√©e de r√©sultat

## üîî ACTUALIT√âS (NEWS FEED)
G√©n√©rer automatiquement pour :
- Nouveau match cr√©√©
- R√©sultat d'un match
- Changement d'√©quipe (hors mercato)
- Joueur marqu√© inactif (raison visible)
- Nouveau mercato lanc√© (teams cr√©√©es al√©atoirement)
- **PAS de d√©tail excessif pour les actions du mercato** (juste "Mercato lanc√©" et √©quipes g√©n√©r√©es)

## üöÄ DEPLOYMENT
- D√©ployer sur **Vercel** (gratuit et optimal pour Next.js)
- Variables env : API Riot, cl√© Supabase, cl√© admin, URL frontend
- DB Supabase h√©berg√©e et accessible partout
- Images stock√©es en Supabase Storage (CDN automatique)

## ‚öôÔ∏è CONFIGURATION REQUISE
Avant de commencer, cr√©er un fichier `.env.local` avec :
```
NEXT_PUBLIC_SUPABASE_URL=xxx
NEXT_PUBLIC_SUPABASE_ANON_KEY=xxx
SUPABASE_SERVICE_KEY=xxx
NEXT_PUBLIC_RIOT_API_KEY=xxx
ADMIN_SECRET_KEY=xxx (cl√© admin √† d√©finir toi-m√™me)
NEXT_PUBLIC_APP_NAME=League Tournament
```

## üìã CHECKLIST DE D√âVELOPPEMENT
- [ ] Setup Next.js + Tailwind + ShadcN
- [ ] Sch√©ma Supabase complet + RLS policies
- [ ] Authentification (login/register/admin key)
- [ ] Pages principales (Accueil, Profil, √âquipes, Matchs, R√®gles)
- [ ] Int√©gration API Riot Games
- [ ] Upload fichiers (Supabase Storage)
- [ ] Syst√®me CRUD complet (joueurs, √©quipes, matchs)
- [ ] Syst√®me Mercato (draft + roue)
- [ ] News feed automatique
- [ ] Calcul winrates
- [ ] Dark/Light mode
- [ ] Responsive design
- [ ] Tests + d√©ploiement Vercel

## üìù NOTES ADDITIONNELLES
- Code clean et comment√©
- Composants r√©utilisables
- Gestion erreurs robuste
- Loading states et skeleton screens
- Messages de confirmation avant actions destructives
- Logs pour debug
- Performance optimis√©e (lazy loading, memoization)

---

**C'est parti ! Demande-moi des clarifications si besoin. Tu as tous les droits Supabase, cr√©e les tables, r√©veille-toi avec un prompt clair et code propre. GL ! üöÄ**